<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDP-RS ç»¼åˆæµ‹è¯•é¡µé¢</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        h1 { margin: 0 0 10px 0; font-size: 2.5em; }
        .subtitle { opacity: 0.9; font-size: 1.1em; }
        .content { padding: 30px; }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .section h2 {
            margin-top: 0;
            color: #667eea;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .test-item {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }
        input, textarea, button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }
        button:hover { background: #5568d3; }
        .iframe-container {
            border: 2px solid #667eea;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        iframe {
            width: 100%;
            height: 200px;
            border: none;
        }
        .shadow-host {
            padding: 15px;
            border: 2px dashed #764ba2;
            border-radius: 4px;
            margin: 10px 0;
        }
        .attribute-demo {
            padding: 10px;
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 4px;
        }
        .status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .status.ready { background: #d4edda; color: #155724; }
        .status.testing { background: #fff3cd; color: #856404; }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        #eventLog {
            height: 150px;
            overflow-y: auto;
            background: #f5f5f5;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .log-entry {
            margin: 2px 0;
            padding: 2px 5px;
            border-left: 3px solid #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ§ª CDP-RS ç»¼åˆæµ‹è¯•é¡µé¢</h1>
            <div class="subtitle">æµ‹è¯•æ‰€æœ‰ CDP åŠŸèƒ½ï¼šè¾“å…¥ã€é€‰æ‹©å™¨ã€Shadow DOMã€IFrame ç­‰</div>
            <div style="margin-top: 10px;">
                <span class="status ready">âœ“ é¡µé¢å°±ç»ª</span>
            </div>
        </header>

        <div class="content">
            <!-- Section 1: æ–‡æœ¬è¾“å…¥æµ‹è¯• -->
            <div class="section">
                <h2>ğŸ“ 1. æ–‡æœ¬è¾“å…¥æµ‹è¯•</h2>
                <div class="test-item">
                    <label><strong>å¿«é€Ÿè¾“å…¥æ¡† (type_text)</strong></label>
                    <input type="text" id="input-fast" placeholder="ç­‰å¾…å¿«é€Ÿè¾“å…¥...">
                </div>
                <div class="test-item">
                    <label><strong>æ¨¡æ‹Ÿè¾“å…¥æ¡† (type_text_with_delay)</strong></label>
                    <input type="text" id="input-slow" placeholder="ç­‰å¾…æ¨¡æ‹Ÿè¾“å…¥...">
                </div>
                <div class="test-item">
                    <label><strong>å¯†ç æ¡†</strong></label>
                    <input type="password" id="input-password" placeholder="å¯†ç è¾“å…¥æµ‹è¯•">
                </div>
                <div class="test-item">
                    <label><strong>æ–‡æœ¬åŒºåŸŸ</strong></label>
                    <textarea id="textarea-main" rows="4" placeholder="å¤šè¡Œæ–‡æœ¬è¾“å…¥æµ‹è¯•..."></textarea>
                </div>
            </div>

            <!-- Section 2: å…ƒç´ å±æ€§æµ‹è¯• -->
            <div class="section">
                <h2>ğŸ·ï¸ 2. å…ƒç´ å±æ€§æµ‹è¯• (getAttribute)</h2>
                <div class="test-item attribute-demo" 
                     data-test-id="attr-demo" 
                     data-value="123"
                     data-status="active"
                     title="è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å…ƒç´ "
                     aria-label="å±æ€§æµ‹è¯•">
                    <p><strong>æ­¤å…ƒç´ åŒ…å«å¤šä¸ªå±æ€§ï¼š</strong></p>
                    <ul>
                        <li>data-test-id="attr-demo"</li>
                        <li>data-value="123"</li>
                        <li>data-status="active"</li>
                        <li>title="è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å…ƒç´ "</li>
                        <li>aria-label="å±æ€§æµ‹è¯•"</li>
                    </ul>
                </div>
            </div>

            <!-- Section 3: å†…å®¹è·å–æµ‹è¯• -->
            <div class="section">
                <h2>ğŸ“„ 3. å†…å®¹è·å–æµ‹è¯• (textContent / innerHTML)</h2>
                <div class="test-item">
                    <div id="content-text">
                        è¿™æ˜¯çº¯æ–‡æœ¬å†…å®¹ï¼ŒåŒ…å« <strong>ç²—ä½“</strong> å’Œ <em>æ–œä½“</em>ã€‚
                    </div>
                </div>
                <div class="test-item">
                    <div id="content-html">
                        <h3>HTML å†…å®¹æµ‹è¯•</h3>
                        <p>æ®µè½ 1</p>
                        <ul>
                            <li>åˆ—è¡¨é¡¹ 1</li>
                            <li>åˆ—è¡¨é¡¹ 2</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Section 4: Shadow DOM æµ‹è¯• -->
            <div class="section">
                <h2>ğŸŒ“ 4. Shadow DOM æµ‹è¯•</h2>
                
                <div class="test-item">
                    <h3>Open Shadow Root</h3>
                    <div id="shadow-open-host" class="shadow-host">
                        <p>Shadow Host (Open)</p>
                    </div>
                </div>

                <div class="test-item">
                    <h3>Closed Shadow Root</h3>
                    <div id="shadow-closed-host" class="shadow-host">
                        <p>Shadow Host (Closed)</p>
                    </div>
                </div>
            </div>

            <!-- Section 5: IFrame æµ‹è¯• -->
            <div class="section">
                <h2>ğŸ–¼ï¸ 5. IFrame æµ‹è¯•</h2>
                
                <div class="test-item">
                    <h3>ç®€å• IFrame</h3>
                    <div class="iframe-container">
                        <iframe id="iframe-simple" name="simple-frame"></iframe>
                    </div>
                </div>

                <div class="test-item">
                    <h3>åµŒå¥— IFrame</h3>
                    <div class="iframe-container">
                        <iframe id="iframe-nested" name="nested-frame"></iframe>
                    </div>
                </div>
            </div>

            <!-- Section 6: æŒ‰é’®å’Œäº¤äº’æµ‹è¯• -->
            <div class="section">
                <h2>ğŸ–±ï¸ 6. äº¤äº’æµ‹è¯• (click, doubleClick)</h2>
                <div class="grid">
                    <div class="test-item">
                        <button id="btn-click">å•å‡»æµ‹è¯•æŒ‰é’®</button>
                        <div id="click-count" style="margin-top: 10px; color: #667eea; font-weight: bold;">
                            ç‚¹å‡»æ¬¡æ•°: 0
                        </div>
                    </div>
                    <div class="test-item">
                        <button id="btn-dblclick">åŒå‡»æµ‹è¯•æŒ‰é’®</button>
                        <div id="dblclick-count" style="margin-top: 10px; color: #764ba2; font-weight: bold;">
                            åŒå‡»æ¬¡æ•°: 0
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 7: querySelectorAll æµ‹è¯• -->
            <div class="section">
                <h2>ğŸ” 7. querySelectorAll æµ‹è¯•</h2>
                <div class="test-item">
                    <div class="list-container">
                        <div class="list-item" data-index="1">åˆ—è¡¨é¡¹ 1</div>
                        <div class="list-item" data-index="2">åˆ—è¡¨é¡¹ 2</div>
                        <div class="list-item" data-index="3">åˆ—è¡¨é¡¹ 3</div>
                        <div class="list-item" data-index="4">åˆ—è¡¨é¡¹ 4</div>
                        <div class="list-item" data-index="5">åˆ—è¡¨é¡¹ 5</div>
                    </div>
                    <p style="color: #666; font-size: 14px;">
                        é€‰æ‹©å™¨: .list-itemï¼ˆåº”è¯¥æ‰¾åˆ° 5 ä¸ªå…ƒç´ ï¼‰
                    </p>
                </div>
            </div>

            <!-- Section 8: äº‹ä»¶æ—¥å¿— -->
            <div class="section">
                <h2>ğŸ“Š 8. äº‹ä»¶æ—¥å¿—</h2>
                <div id="eventLog"></div>
            </div>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ– Shadow DOM (Open)
        const shadowOpenHost = document.getElementById('shadow-open-host');
        const shadowOpenRoot = shadowOpenHost.attachShadow({ mode: 'open' });
        shadowOpenRoot.innerHTML = `
            <style>
                .shadow-content {
                    padding: 15px;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    border-radius: 4px;
                }
                input {
                    width: 100%;
                    padding: 8px;
                    margin-top: 10px;
                    border: none;
                    border-radius: 4px;
                }
            </style>
            <div class="shadow-content">
                <h4>âœ¨ Open Shadow Root å†…å®¹</h4>
                <p>è¿™æ˜¯ Open Shadow DOM ä¸­çš„å†…å®¹</p>
                <input type="text" id="shadow-open-input" placeholder="Shadow DOM è¾“å…¥æ¡† (Open)">
            </div>
        `;

        // åˆå§‹åŒ– Shadow DOM (Closed)
        const shadowClosedHost = document.getElementById('shadow-closed-host');
        const shadowClosedRoot = shadowClosedHost.attachShadow({ mode: 'closed' });
        shadowClosedRoot.innerHTML = `
            <style>
                .shadow-content {
                    padding: 15px;
                    background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
                    color: white;
                    border-radius: 4px;
                }
                input {
                    width: 100%;
                    padding: 8px;
                    margin-top: 10px;
                    border: none;
                    border-radius: 4px;
                }
            </style>
            <div class="shadow-content">
                <h4>ğŸ”’ Closed Shadow Root å†…å®¹</h4>
                <p>è¿™æ˜¯ Closed Shadow DOM ä¸­çš„å†…å®¹</p>
                <input type="text" id="shadow-closed-input" placeholder="Shadow DOM è¾“å…¥æ¡† (Closed)">
            </div>
        `;

        // åˆå§‹åŒ– IFrame
        const iframeSimple = document.getElementById('iframe-simple');
        iframeSimple.srcdoc = `
            <!DOCTYPE html>
            <html>
            <head>
                <style>
                    body { 
                        font-family: Arial; 
                        padding: 20px; 
                        background: #e3f2fd;
                        margin: 0;
                    }
                    h3 { color: #1976d2; }
                    input { 
                        width: 100%; 
                        padding: 8px; 
                        margin-top: 10px;
                        border: 2px solid #1976d2;
                        border-radius: 4px;
                    }
                </style>
            </head>
            <body>
                <h3>ğŸ“¦ IFrame å†…å®¹</h3>
                <p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ IFrame</p>
                <input type="text" id="iframe-input" placeholder="IFrame ä¸­çš„è¾“å…¥æ¡†">
            </body>
            </html>
        `;

        // åˆå§‹åŒ–åµŒå¥— IFrame
        const iframeNested = document.getElementById('iframe-nested');
        iframeNested.srcdoc = `
            <!DOCTYPE html>
            <html>
            <head>
                <style>
                    body { 
                        font-family: Arial; 
                        padding: 20px; 
                        background: #fff3e0;
                        margin: 0;
                    }
                    h3 { color: #f57c00; }
                    .nested-container {
                        margin-top: 10px;
                        border: 2px solid #f57c00;
                        border-radius: 4px;
                        overflow: hidden;
                    }
                </style>
            </head>
            <body>
                <h3>ğŸ”— åµŒå¥— IFrame (Level 1)</h3>
                <p>è¿™ä¸ª IFrame åŒ…å«å¦ä¸€ä¸ª IFrame</p>
                <div class="nested-container">
                    <iframe id="nested-inner" style="width: 100%; height: 120px; border: none;"></iframe>
                </div>
                <script>
                    const innerFrame = document.getElementById('nested-inner');
                    innerFrame.srcdoc = \`
                        <!DOCTYPE html>
                        <html>
                        <head>
                            <style>
                                body { 
                                    font-family: Arial; 
                                    padding: 15px; 
                                    background: #e8f5e9;
                                    margin: 0;
                                }
                                h4 { color: #388e3c; margin: 0 0 10px 0; }
                                input { 
                                    width: 100%; 
                                    padding: 6px;
                                    border: 2px solid #388e3c;
                                    border-radius: 4px;
                                }
                            </style>
                        </head>
                        <body>
                            <h4>ğŸ¯ åµŒå¥— IFrame (Level 2)</h4>
                            <input type="text" id="nested-input" placeholder="åµŒå¥— IFrame è¾“å…¥æ¡†">
                        </body>
                        </html>
                    \`;
                <\/script>
            </body>
            </html>
        `;

        // äº‹ä»¶æ—¥å¿—åŠŸèƒ½
        const eventLog = document.getElementById('eventLog');
        function logEvent(message) {
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            const time = new Date().toLocaleTimeString('zh-CN');
            entry.textContent = `[${time}] ${message}`;
            eventLog.appendChild(entry);
            eventLog.scrollTop = eventLog.scrollHeight;
        }

        // æŒ‰é’®ç‚¹å‡»è®¡æ•°
        let clickCount = 0;
        let dblClickCount = 0;

        document.getElementById('btn-click').addEventListener('click', () => {
            clickCount++;
            document.getElementById('click-count').textContent = `ç‚¹å‡»æ¬¡æ•°: ${clickCount}`;
            logEvent(`å•å‡»æŒ‰é’® (æ€»è®¡: ${clickCount})`);
        });

        document.getElementById('btn-dblclick').addEventListener('dblclick', () => {
            dblClickCount++;
            document.getElementById('dblclick-count').textContent = `åŒå‡»æ¬¡æ•°: ${dblClickCount}`;
            logEvent(`åŒå‡»æŒ‰é’® (æ€»è®¡: ${dblClickCount})`);
        });

        // ç›‘å¬æ‰€æœ‰è¾“å…¥æ¡†çš„å˜åŒ–
        document.querySelectorAll('input, textarea').forEach(el => {
            el.addEventListener('input', (e) => {
                logEvent(`è¾“å…¥äº‹ä»¶: ${e.target.id || e.target.placeholder} = "${e.target.value}"`);
            });
        });

        // é¡µé¢åŠ è½½å®Œæˆæ—¥å¿—
        logEvent('âœ… é¡µé¢åŠ è½½å®Œæˆï¼Œæ‰€æœ‰åŠŸèƒ½å·²å°±ç»ª');
        logEvent('ğŸ“ ç­‰å¾…æµ‹è¯•è„šæœ¬æ‰§è¡Œ...');
    </script>
</body>
</html>
